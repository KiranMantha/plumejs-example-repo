"use strict";(self.webpackChunkplumejs_example_repo=self.webpackChunkplumejs_example_repo||[]).push([[128],{128:function(t,e,a){a.d(e,{E:function(){return u},o:function(){return i}});var r=a(732),s=a(302);class n{static routeList=[];static isHistoryBasedRouting=!0;static checkParams(t,e){let a=0;const r={},s=e.paramCount;for(let s=0;s<t.length;s++){const n=e.params[s];n.indexOf(":")>=0&&(r[n.split(":")[1]]=t[s].split("?")[0],a+=1)}return a===s?r:{}}static getParamCount(t){let e=0;return t.forEach((t=>{t.indexOf(":")>=0&&(e+=1)})),e}static formatRoute(t){const e={params:{},url:"",template:"",paramCount:0,isRegistered:!1,redirectTo:"",preload:t.preload,canActivate:()=>!0};if(e.params=t.path.split("/").filter((t=>t.length>0)),e.url=t.path,e.template="",e.redirectTo=t.redirectTo,t.template){if(!t.templatePath)throw Error("templatePath is required in route if template is mentioned.");e.template=t.template,e.templatePath=t.templatePath}t.canActivate&&(e.canActivate=t.canActivate),e.paramCount=n.getParamCount(e.params),n.routeList.push(e)}static preloadRoutes(){for(const t of n.routeList)t.templatePath&&t.templatePath()}static preloadSelectedRoutes(){const t=n.routeList.filter((t=>!0===t.preload));for(const e of t)e.templatePath&&e.templatePath()}}const i=(t,e)=>!(!t||!e)&&new RegExp(t.replace(/:[^\s/]+/g,"(.+)")).test(e);let o=class{_currentRoute=new s.BehaviourSubjectObs({path:"",routeParams:new Map,queryParams:new Map,state:{}});_template=new s.BehaviourSubjectObs("");_navigationEndEvent=new s.SubjectObs;_routeStateMap=new Map;listenRouteChanges(){const t=n.isHistoryBasedRouting?"popstate":"hashchange";return n.isHistoryBasedRouting&&(window.history.replaceState({},null,""),function(t,e){const a=t.pushState;t.pushState=function(...r){a.apply(t,r),e()}}(window.history,this._registerOnHashChange.bind(this))),(0,s.fromEvent)(window,t,(()=>{this._registerOnHashChange()}))}getTemplate(){return this._template.asObservable()}getCurrentRoute(){return this._currentRoute.asObservable()}navigateTo(t="/",e){let a=n.isHistoryBasedRouting?window.location.pathname:window.location.hash.replace(/^#/,"");a=a||"/",this._routeStateMap.clear(),this._routeStateMap.set(t,e),a===t?this._navigateTo(t,e):n.isHistoryBasedRouting?window.history.pushState(e,"",t):window.location.hash="#"+t}onNavigationEnd(){return this._navigationEndEvent.asObservable()}_registerOnHashChange(){const t=n.isHistoryBasedRouting?window.location.pathname:window.location.hash.replace(/^#/,""),e=this._routeStateMap.get(t);this._navigateTo(t,e)}_navigateTo(t,e){const a={},r=t.split("/").filter((t=>t.length>0)),o=n.routeList.filter((e=>e.params.length===r.length&&i(e.url,t)||e.url===t?e:void 0)),l=o.length>0?o[0]:null;l&&(a.path=t,a.state={...e||{}},(0,s.wrapIntoObservable)(l.canActivate()).subscribe((i=>{if(!i)return;const o=n.checkParams(r,l);if(Object.keys(o).length>0||t){a.routeParams=new Map(Object.entries(o));let t=[];t=n.isHistoryBasedRouting?new URLSearchParams(window.location.search).entries():window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[],a.queryParams=new Map(t);const r=t=>{t.isRegistered=!0,this._currentRoute.next(a),this._template.next(t.template),this._navigationEndEvent.next(null)};l.isRegistered?r(l):l.templatePath?(0,s.wrapIntoObservable)(l.templatePath()).subscribe((()=>{r(l)})):l.redirectTo&&this.navigateTo(l.redirectTo,e)}else this.navigateTo(l.redirectTo,e)})))}};o=(0,r.UN)([(0,s.Injectable)()],o);let l=class{internalRouterSrvc;renderer;_template="";_subscriptions=new s.Subscriptions;constructor(t,e){this.internalRouterSrvc=t,this.renderer=e}beforeMount(){this._subscriptions.add(this.internalRouterSrvc.getTemplate().subscribe((t=>{this._template!==t&&(this._template=t)}))),this._subscriptions.add(this.internalRouterSrvc.listenRouteChanges())}mount(){const t=n.isHistoryBasedRouting?window.location.pathname:window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(t||"/",null)}unmount(){this._subscriptions.unsubscribe()}render(){if(this._template){const t=[`${this._template}`];return t.raw=[`${this._template}`],(0,s.html)(t)}return s.html``}};l=(0,r.UN)([(0,s.Component)({selector:"router-outlet",deps:[o,s.Renderer]}),(0,r.YR)("design:paramtypes",[o,s.Renderer])],l);let u=class{internalRouter;constructor(t){this.internalRouter=t}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(t,e){this.internalRouter.navigateTo(t,e)}onNavigationEnd(){return this.internalRouter.onNavigationEnd()}static registerRoutes({routes:t,preloadAllRoutes:e=!1,isHashBasedRouting:a=!1}){if(a&&(n.isHistoryBasedRouting=!a),!Array.isArray(t))throw Error("router.addRoutes: the parameter must be an array");for(const e of t)n.formatRoute(e);e?n.preloadRoutes():n.preloadSelectedRoutes()}};u=(0,r.UN)([(0,s.Injectable)({deps:[o]}),(0,r.YR)("design:paramtypes",[o])],u)}}]);
//# sourceMappingURL=../sourcemaps/128.js.map