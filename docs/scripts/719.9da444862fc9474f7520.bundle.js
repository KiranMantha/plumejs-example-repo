"use strict";(self.webpackChunkplumejs_example_repo=self.webpackChunkplumejs_example_repo||[]).push([[719],{719:(t,e,r)=>{r.d(e,{F:()=>l});var a=r(655),s=r(394);class StaticRouter{static routeList=[];static checkParams(t,e){let r=0;const a={},s=e.ParamCount;for(let s=0;s<t.length;s++){const n=e.Params[s];n.indexOf(":")>=0&&(a[n.split(":")[1]]=t[s],r+=1)}return r===s?a:{}}static getParamCount(t){let e=0;return t.forEach((t=>{t.indexOf(":")>=0&&(e+=1)})),e}static formatRoute(t){const e={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(e.Params=t.path.split("/").filter((t=>t.length>0)),e.Url=t.path,e.Template="",e.redirectTo=t.redirectTo,t.template){if(!t.templatePath)throw Error("templatePath is required in route if template is mentioned.");e.Template=t.template,e.TemplatePath=t.templatePath}t.canActivate&&(e.canActivate=t.canActivate),e.ParamCount=StaticRouter.getParamCount(e.Params),StaticRouter.routeList.push(e)}static preloadRoutes(){for(const t of StaticRouter.routeList)t.TemplatePath&&t.TemplatePath()}}class SubjectObs{_internalFn;asObservable(){return{subscribe:t=>this.subscribe(t)}}subscribe(t){return this._internalFn=t,this.unsubscribe}unsubscribe(){this._internalFn=null}next(t){this._internalFn(t)}}const n=t=>{return(e=t)&&"function"==typeof e.subscribe?t:(t=>!!t&&"function"==typeof t.then)(t)?(r=Promise.resolve(t),{subscribe:t=>{Promise.resolve(r).then((e=>{t(e)}))}}):(t=>({subscribe:e=>{e(t)}}))(t);var e,r};let i=class InternalRouter{_currentRoute={path:"",params:{},state:{}};_template=new SubjectObs;_unSubscribeHashEvent;startHashChange(){this._unSubscribeHashEvent=((t,e,r,a=!1)=>(t.addEventListener(e,r,a),()=>{t.removeEventListener(e,r,a)}))(window,"hashchange",(()=>{this._registerOnHashChange()}))}stopHashChange(){this._unSubscribeHashEvent()}getTemplate(){return this._template.asObservable()}getCurrentRoute(){return this._currentRoute}navigateTo(t="",e){if(t){window.location.hash.replace(/^#/,"")===t&&this._navigateTo(t,e),window.location.hash="#"+t}else this._navigateTo(t,e)}_registerOnHashChange(){const t=window.location.hash.replace(/^#/,"");this._navigateTo(t,null)}_routeMatcher(t,e){if(t){const r=new RegExp(t.replace(/:[^\s/]+/g,"([\\w-]+)"));return e.match(r)}return t===e}_navigateTo(t,e){const r=t.split("/").filter((t=>t.length>0)),a=StaticRouter.routeList.filter((e=>e.Params.length===r.length&&this._routeMatcher(e.Url,t)||e.Url===t?e:void 0)),s=a.length>0?a[0]:null;s&&(this._currentRoute.path=t,this._currentRoute.state={...e||{}},n(s.canActivate()).subscribe((a=>{if(!a)return;const i=StaticRouter.checkParams(r,s);Object.keys(i).length>0||t?(this._currentRoute.params=i,s.IsRegistered?this._template.next(s.Template):s.TemplatePath&&n(s.TemplatePath()).subscribe((()=>{s.IsRegistered=!0,this._template.next(s.Template)}))):this.navigateTo(s.redirectTo,e)})))}};i=(0,a.gn)([(0,s.GS)()],i);let o=class RouterOutlet{internalRouterSrvc;renderer;_template="";_templateSubscription;constructor(t,e){this.internalRouterSrvc=t,this.renderer=e}beforeMount(){this._templateSubscription=this.internalRouterSrvc.getTemplate().subscribe((t=>{this._template=t,this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){const t=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(t,null)}unmount(){this._templateSubscription(),this.internalRouterSrvc.stopHashChange()}render(){if(this._template){const t=[`${this._template}`];return t.raw=[`${this._template}`],(0,s.dy)(t)}return s.dy``}};o=(0,a.gn)([(0,s.wA)({selector:"router-outlet"}),(0,a.w6)("design:paramtypes",[i,s.Th])],o);var u=r(818);let l=class Router{internalRouter;constructor(t){this.internalRouter=t}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(t,e){this.internalRouter.navigateTo(t,e)}static registerRoutes(t,e=!1){if(!u.UG){if(!Array.isArray(t))throw Error("router.addRoutes: the parameter must be an array");for(const e of t)StaticRouter.formatRoute(e);e&&StaticRouter.preloadRoutes()}}};l=(0,a.gn)([(0,s.GS)(),(0,a.w6)("design:paramtypes",[i])],l)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyaXB0cy83MTkuOWRhNDQ0ODYyZmM5NDc0Zjc1MjAuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJpS0FBTyxNQUFNQSxhQUNUQyxpQkFBbUIsR0FDbkJBLG1CQUFtQkMsRUFBSUMsR0FDbkIsSUFBSUMsRUFBTSxFQUNWLE1BQU1DLEVBQUssR0FBSUMsRUFBS0gsRUFBRUksV0FDdEIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlOLEVBQUdPLE9BQVFELElBQUssQ0FDaEMsTUFBTUUsRUFBVVAsRUFBRVEsT0FBT0gsR0FDckJFLEVBQVFFLFFBQVEsTUFBUSxJQUN4QlAsRUFBR0ssRUFBUUcsTUFBTSxLQUFLLElBQU1YLEVBQUdNLEdBQy9CSixHQUFPLEdBR2YsT0FBSUEsSUFBUUUsRUFDREQsRUFFSixHQUVYSixxQkFBcUJhLEdBQ2pCLElBQUlSLEVBQUssRUFNVCxPQUxBUSxFQUFFQyxTQUFTQyxJQUNIQSxFQUFFSixRQUFRLE1BQVEsSUFDbEJOLEdBQU0sTUFHUEEsRUFFWEwsbUJBQW1CRSxHQUNmLE1BQU1jLEVBQU0sQ0FDUk4sT0FBUSxHQUNSTyxJQUFLLEdBQ0xDLFNBQVUsR0FDVlosV0FBWSxFQUNaYSxjQUFjLEVBQ2RDLFdBQVksR0FDWkMsWUFBYSxLQUFNLEdBUXZCLEdBTkFMLEVBQUlOLE9BQVNSLEVBQUVvQixLQUFLVixNQUFNLEtBQUtXLFFBQVFDLEdBQzVCQSxFQUFFaEIsT0FBUyxJQUV0QlEsRUFBSUMsSUFBTWYsRUFBRW9CLEtBQ1pOLEVBQUlFLFNBQVcsR0FDZkYsRUFBSUksV0FBYWxCLEVBQUVrQixXQUNmbEIsRUFBRXVCLFNBQVUsQ0FDWixJQUFLdkIsRUFBRXdCLGFBQ0gsTUFBTUMsTUFBTSwrREFDaEJYLEVBQUlFLFNBQVdoQixFQUFFdUIsU0FDakJULEVBQUlZLGFBQWUxQixFQUFFd0IsYUFFckJ4QixFQUFFbUIsY0FDRkwsRUFBSUssWUFBY25CLEVBQUVtQixhQUN4QkwsRUFBSVYsV0FBYVAsYUFBYThCLGNBQWNiLEVBQUlOLFFBQ2hEWCxhQUFhK0IsVUFBVUMsS0FBS2YsR0FFaENoQix1QkFDSSxJQUFLLE1BQU1nQyxLQUFTakMsYUFBYStCLFVBQzdCRSxFQUFNSixjQUFnQkksRUFBTUosZ0JDckN4QyxNQUFNSyxXQUNGQyxZQUNBQyxlQUNJLE1BQU8sQ0FDSEMsVUFBWUMsR0FDREMsS0FBS0YsVUFBVUMsSUFJbENELFVBQVVDLEdBRU4sT0FEQUMsS0FBS0osWUFBY0csRUFDWkMsS0FBS0MsWUFFaEJBLGNBQ0lELEtBQUtKLFlBQWMsS0FFdkJNLEtBQUtDLEdBQ0RILEtBQUtKLFlBQVlPLElBR3pCLE1BQU1DLEVBQXNCRCxJQUN4QixPQXZDa0J6QixFQXVDRHlCLElBdkMyQyxtQkFBbEJ6QixFQUFJb0IsVUF3Q25DSyxFQXZDRyxDQUFDekIsS0FBVUEsR0FBMkIsbUJBQWJBLEVBQUkyQixLQXlDdkNDLENBQVVILElBakNNSSxFQWtDTUMsUUFBUUMsUUFBUU4sR0FqQ25DLENBQ0hMLFVBQVlDLElBQ1JTLFFBQVFDLFFBQVFGLEdBQU9GLE1BQU1GLElBQ3pCSixFQUFHSSxTQVhMLENBQUNJLElBQ0osQ0FDSFQsVUFBWUMsSUFDUkEsRUFBR1EsTUF3Q0pHLENBQU1QLEdBN0NJLElBQUN6QixFQVNFNkIsR0NMeEIsSUFBSUksRUFBaUIsTUFBTUEsZUFDdkJDLGNBQWdCLENBQ1o1QixLQUFNLEdBQ042QixPQUFRLEdBQ1JDLE1BQU8sSUFFWEMsVUFBWSxJQUFJcEIsV0FDaEJxQixzQkFDQUMsa0JBQ0lqQixLQUFLZ0Isc0JEa0NZLEVBQUNFLEVBQVFDLEVBQVdDLEVBQVFDLEdBQVUsS0FDM0RILEVBQU9JLGlCQUFpQkgsRUFBV0MsRUFBUUMsR0FDdkIsS0FDaEJILEVBQU9LLG9CQUFvQkosRUFBV0MsRUFBUUMsS0NyQ2pCRyxDQUFpQkMsT0FBUSxjQUFjLEtBQ2hFekIsS0FBSzBCLDJCQUdiQyxpQkFDSTNCLEtBQUtnQix3QkFFVFksY0FDSSxPQUFPNUIsS0FBS2UsVUFBVWxCLGVBRTFCZ0Msa0JBQ0ksT0FBTzdCLEtBQUtZLGNBRWhCa0IsV0FBVzlDLEVBQU8sR0FBSThCLEdBQ2xCLEdBQUk5QixFQUFNLENBQ2F5QyxPQUFPTSxTQUFTQyxLQUFLQyxRQUFRLEtBQU0sTUFDbkNqRCxHQUNmZ0IsS0FBS2tDLFlBQVlsRCxFQUFNOEIsR0FFM0JXLE9BQU9NLFNBQVNDLEtBQU8sSUFBTWhELE9BRzdCZ0IsS0FBS2tDLFlBQVlsRCxFQUFNOEIsR0FHL0JZLHdCQUNJLE1BQU0xQyxFQUFPeUMsT0FBT00sU0FBU0MsS0FBS0MsUUFBUSxLQUFNLElBQ2hEakMsS0FBS2tDLFlBQVlsRCxFQUFNLE1BRTNCbUQsY0FBY3pDLEVBQU9WLEdBQ2pCLEdBQUlVLEVBQU8sQ0FDUCxNQUFNMEMsRUFBVyxJQUFJQyxPQUFPM0MsRUFBTXVDLFFBQVEsWUFBYSxjQUN2RCxPQUFPakQsRUFBS3NELE1BQU1GLEdBR2xCLE9BQU8xQyxJQUFVVixFQUd6QmtELFlBQVlsRCxFQUFNOEIsR0FDZCxNQUFNeUIsRUFBVXZELEVBQUtWLE1BQU0sS0FBS1csUUFBUUMsR0FDN0JBLEVBQUVoQixPQUFTLElBRWhCc0UsRUFBVy9FLGFBQWErQixVQUFVUCxRQUFRUyxHQUN4Q0EsRUFBTXRCLE9BQU9GLFNBQVdxRSxFQUFRckUsUUFBVThCLEtBQUttQyxjQUFjekMsRUFBTWYsSUFBS0ssSUFHbkVVLEVBQU1mLE1BQVFLLEVBRlpVLE9BRU4sSUFJSCtDLEVBQVlELEVBQVN0RSxPQUFTLEVBQUlzRSxFQUFTLEdBQUssS0FDbERDLElBQ0F6QyxLQUFLWSxjQUFjNUIsS0FBT0EsRUFDMUJnQixLQUFLWSxjQUFjRSxNQUFRLElBQU1BLEdBQVMsSUFDMUNWLEVBQW1CcUMsRUFBVTFELGVBQWVlLFdBQVc0QyxJQUNuRCxJQUFLQSxFQUNELE9BQ0osTUFBTUMsRUFBVWxGLGFBQWFtRixZQUFZTCxFQUFTRSxHQUM5Q0ksT0FBT0MsS0FBS0gsR0FBU3pFLE9BQVMsR0FBS2MsR0FDbkNnQixLQUFLWSxjQUFjQyxPQUFTOEIsRUFDdkJGLEVBQVU1RCxhQVNYbUIsS0FBS2UsVUFBVWIsS0FBS3VDLEVBQVU3RCxVQVIxQjZELEVBQVVuRCxjQUNWYyxFQUFtQnFDLEVBQVVuRCxnQkFBZ0JRLFdBQVUsS0FDbkQyQyxFQUFVNUQsY0FBZSxFQUN6Qm1CLEtBQUtlLFVBQVViLEtBQUt1QyxFQUFVN0QsY0FTMUNvQixLQUFLOEIsV0FBV1csRUFBVTNELFdBQVlnQyxTQU0xREgsR0FBaUIsUUFBVyxFQUN4QixXQUNEQSxHQzNGSCxJQUFJb0MsRUFBZSxNQUFNQSxhQUNyQkMsbUJBQ0FDLFNBQ0FsQyxVQUFZLEdBQ1ptQyxzQkFDQUMsWUFBWUgsRUFBb0JDLEdBQzVCakQsS0FBS2dELG1CQUFxQkEsRUFDMUJoRCxLQUFLaUQsU0FBV0EsRUFFcEJHLGNBQ0lwRCxLQUFLa0Qsc0JBQXdCbEQsS0FBS2dELG1CQUFtQnBCLGNBQWM5QixXQUFXdUQsSUFDMUVyRCxLQUFLZSxVQUFZc0MsRUFDakJyRCxLQUFLaUQsU0FBU0ssWUFFbEJ0RCxLQUFLZ0QsbUJBQW1CL0Isa0JBRTVCc0MsUUFDSSxNQUFNdkUsRUFBT3lDLE9BQU9NLFNBQVNDLEtBQUtDLFFBQVEsS0FBTSxJQUNoRGpDLEtBQUtnRCxtQkFBbUJsQixXQUFXOUMsRUFBTSxNQUU3Q3dFLFVBQ0l4RCxLQUFLa0Qsd0JBQ0xsRCxLQUFLZ0QsbUJBQW1CckIsaUJBRTVCOEIsU0FDSSxHQUFJekQsS0FBS2UsVUFBVyxDQUNoQixNQUFNMkMsRUFBYyxDQUFDLEdBQUcxRCxLQUFLZSxhQUU3QixPQURBMkMsRUFBWUMsSUFBTSxDQUFDLEdBQUczRCxLQUFLZSxjQUNwQixRQUFLMkMsR0FHWixPQUFPLElBQUssS0FJeEJYLEdBQWUsUUFBVyxFQUN0QixRQUFVLENBQ05hLFNBQVUsbUJBRWQsUUFBVyxvQkFBcUIsQ0FBQ2pELEVBQWdCLFFBQ2xEb0MsRyxhQ3RDSCxJQUFJYyxFQUFTLE1BQU1BLE9BQ2ZDLGVBQ0FYLFlBQVlXLEdBQ1I5RCxLQUFLOEQsZUFBaUJBLEVBRTFCakMsa0JBQ0ksT0FBTzdCLEtBQUs4RCxlQUFlakMsa0JBRS9CQyxXQUFXOUMsRUFBTThCLEdBQ2JkLEtBQUs4RCxlQUFlaEMsV0FBVzlDLEVBQU04QixHQUV6Q3BELHNCQUFzQnFHLEVBQVFDLEdBQW1CLEdBQzdDLElBQUssS0FBUSxDQUNULElBQUlDLE1BQU1DLFFBQVFILEdBT2QsTUFBTTFFLE1BQU0sb0RBTlosSUFBSyxNQUFNSyxLQUFTcUUsRUFDaEJ0RyxhQUFhMEcsWUFBWXpFLEdBRTdCc0UsR0FBb0J2RyxhQUFhMkcsbUJBUWpEUCxHQUFTLFFBQVcsRUFDaEIsV0FDQSxRQUFXLG9CQUFxQixDQUFDbEQsS0FDbENrRCIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AcGx1bWVqcy9yb3V0ZXIvZGlzdC9tanMvc3JjL3N0YXRpY1JvdXRlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHBsdW1lanMvcm91dGVyL2Rpc3QvbWpzL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHBsdW1lanMvcm91dGVyL2Rpc3QvbWpzL3NyYy9pbnRlcm5hbFJvdXRlci5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AcGx1bWVqcy9yb3V0ZXIvZGlzdC9tanMvc3JjL3JvdXRlci5jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BwbHVtZWpzL3JvdXRlci9kaXN0L21qcy9zcmMvcm91dGVyLnNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFN0YXRpY1JvdXRlciB7XG4gICAgc3RhdGljIHJvdXRlTGlzdCA9IFtdO1xuICAgIHN0YXRpYyBjaGVja1BhcmFtcyh1cCwgcikge1xuICAgICAgICBsZXQgcG1jID0gMDtcbiAgICAgICAgY29uc3QgcG8gPSB7fSwgcGMgPSByLlBhcmFtQ291bnQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHJ0UGFyYW0gPSByLlBhcmFtc1tpXTtcbiAgICAgICAgICAgIGlmIChydFBhcmFtLmluZGV4T2YoJzonKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcG9bcnRQYXJhbS5zcGxpdCgnOicpWzFdXSA9IHVwW2ldO1xuICAgICAgICAgICAgICAgIHBtYyArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwbWMgPT09IHBjKSB7XG4gICAgICAgICAgICByZXR1cm4gcG87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0UGFyYW1Db3VudChwKSB7XG4gICAgICAgIGxldCBwYyA9IDA7XG4gICAgICAgIHAuZm9yRWFjaCgoaykgPT4ge1xuICAgICAgICAgICAgaWYgKGsuaW5kZXhPZignOicpID49IDApIHtcbiAgICAgICAgICAgICAgICBwYyArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHBjO1xuICAgIH1cbiAgICBzdGF0aWMgZm9ybWF0Um91dGUocikge1xuICAgICAgICBjb25zdCBvYmogPSB7XG4gICAgICAgICAgICBQYXJhbXM6IHt9LFxuICAgICAgICAgICAgVXJsOiAnJyxcbiAgICAgICAgICAgIFRlbXBsYXRlOiAnJyxcbiAgICAgICAgICAgIFBhcmFtQ291bnQ6IDAsXG4gICAgICAgICAgICBJc1JlZ2lzdGVyZWQ6IGZhbHNlLFxuICAgICAgICAgICAgcmVkaXJlY3RUbzogJycsXG4gICAgICAgICAgICBjYW5BY3RpdmF0ZTogKCkgPT4gdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICBvYmouUGFyYW1zID0gci5wYXRoLnNwbGl0KCcvJykuZmlsdGVyKChoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaC5sZW5ndGggPiAwO1xuICAgICAgICB9KTtcbiAgICAgICAgb2JqLlVybCA9IHIucGF0aDtcbiAgICAgICAgb2JqLlRlbXBsYXRlID0gJyc7XG4gICAgICAgIG9iai5yZWRpcmVjdFRvID0gci5yZWRpcmVjdFRvO1xuICAgICAgICBpZiAoci50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgaWYgKCFyLnRlbXBsYXRlUGF0aClcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcigndGVtcGxhdGVQYXRoIGlzIHJlcXVpcmVkIGluIHJvdXRlIGlmIHRlbXBsYXRlIGlzIG1lbnRpb25lZC4nKTtcbiAgICAgICAgICAgIG9iai5UZW1wbGF0ZSA9IHIudGVtcGxhdGU7XG4gICAgICAgICAgICBvYmouVGVtcGxhdGVQYXRoID0gci50ZW1wbGF0ZVBhdGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHIuY2FuQWN0aXZhdGUpXG4gICAgICAgICAgICBvYmouY2FuQWN0aXZhdGUgPSByLmNhbkFjdGl2YXRlO1xuICAgICAgICBvYmouUGFyYW1Db3VudCA9IFN0YXRpY1JvdXRlci5nZXRQYXJhbUNvdW50KG9iai5QYXJhbXMpO1xuICAgICAgICBTdGF0aWNSb3V0ZXIucm91dGVMaXN0LnB1c2gob2JqKTtcbiAgICB9XG4gICAgc3RhdGljIHByZWxvYWRSb3V0ZXMoKSB7XG4gICAgICAgIGZvciAoY29uc3Qgcm91dGUgb2YgU3RhdGljUm91dGVyLnJvdXRlTGlzdCkge1xuICAgICAgICAgICAgcm91dGUuVGVtcGxhdGVQYXRoICYmIHJvdXRlLlRlbXBsYXRlUGF0aCgpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiY29uc3QgaXNPYnNlcnZhYmxlID0gKG9iaikgPT4gISFvYmogJiYgdHlwZW9mIG9iai5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbic7XG5jb25zdCBpc1Byb21pc2UgPSAob2JqKSA9PiAhIW9iaiAmJiB0eXBlb2Ygb2JqLnRoZW4gPT09ICdmdW5jdGlvbic7XG5jb25zdCBvZk9icyA9IChpbnB1dCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIHN1YnNjcmliZTogKGZuKSA9PiB7XG4gICAgICAgICAgICBmbihpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbmNvbnN0IGZyb21Qcm9taXNlT2JzID0gKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3Vic2NyaWJlOiAoZm4pID0+IHtcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShpbnB1dCkudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBmbih2YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuY2xhc3MgU3ViamVjdE9icyB7XG4gICAgX2ludGVybmFsRm47XG4gICAgYXNPYnNlcnZhYmxlKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3Vic2NyaWJlOiAoZm4pID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmUoZm4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBzdWJzY3JpYmUoZm4pIHtcbiAgICAgICAgdGhpcy5faW50ZXJuYWxGbiA9IGZuO1xuICAgICAgICByZXR1cm4gdGhpcy51bnN1YnNjcmliZTtcbiAgICB9XG4gICAgdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgIHRoaXMuX2ludGVybmFsRm4gPSBudWxsO1xuICAgIH1cbiAgICBuZXh0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2ludGVybmFsRm4odmFsdWUpO1xuICAgIH1cbn1cbmNvbnN0IHdyYXBJbnRvT2JzZXJ2YWJsZSA9ICh2YWx1ZSkgPT4ge1xuICAgIGlmIChpc09ic2VydmFibGUodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgaWYgKGlzUHJvbWlzZSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZyb21Qcm9taXNlT2JzKFByb21pc2UucmVzb2x2ZSh2YWx1ZSkpO1xuICAgIH1cbiAgICByZXR1cm4gb2ZPYnModmFsdWUpO1xufTtcbmNvbnN0IGZyb21WYW5pbGxhRXZlbnQgPSAodGFyZ2V0LCBldmVudE5hbWUsIG9uTmV4dCwgb3B0aW9ucyA9IGZhbHNlKSA9PiB7XG4gICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBvbk5leHQsIG9wdGlvbnMpO1xuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIG9uTmV4dCwgb3B0aW9ucyk7XG4gICAgfTtcbiAgICByZXR1cm4gdW5zdWJzY3JpYmU7XG59O1xuZXhwb3J0IHsgd3JhcEludG9PYnNlcnZhYmxlLCBTdWJqZWN0T2JzLCBmcm9tVmFuaWxsYUV2ZW50IH07XG4iLCJpbXBvcnQgeyBfX2RlY29yYXRlIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQHBsdW1lanMvY29yZSc7XG5pbXBvcnQgeyBTdGF0aWNSb3V0ZXIgfSBmcm9tICcuL3N0YXRpY1JvdXRlcic7XG5pbXBvcnQgeyB3cmFwSW50b09ic2VydmFibGUsIFN1YmplY3RPYnMsIGZyb21WYW5pbGxhRXZlbnQgfSBmcm9tICcuL3V0aWxzJztcbmxldCBJbnRlcm5hbFJvdXRlciA9IGNsYXNzIEludGVybmFsUm91dGVyIHtcbiAgICBfY3VycmVudFJvdXRlID0ge1xuICAgICAgICBwYXRoOiAnJyxcbiAgICAgICAgcGFyYW1zOiB7fSxcbiAgICAgICAgc3RhdGU6IHt9XG4gICAgfTtcbiAgICBfdGVtcGxhdGUgPSBuZXcgU3ViamVjdE9icygpO1xuICAgIF91blN1YnNjcmliZUhhc2hFdmVudDtcbiAgICBzdGFydEhhc2hDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMuX3VuU3Vic2NyaWJlSGFzaEV2ZW50ID0gZnJvbVZhbmlsbGFFdmVudCh3aW5kb3csICdoYXNoY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJPbkhhc2hDaGFuZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0b3BIYXNoQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLl91blN1YnNjcmliZUhhc2hFdmVudCgpO1xuICAgIH1cbiAgICBnZXRUZW1wbGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlLmFzT2JzZXJ2YWJsZSgpO1xuICAgIH1cbiAgICBnZXRDdXJyZW50Um91dGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50Um91dGU7XG4gICAgfVxuICAgIG5hdmlnYXRlVG8ocGF0aCA9ICcnLCBzdGF0ZSkge1xuICAgICAgICBpZiAocGF0aCkge1xuICAgICAgICAgICAgY29uc3Qgd2luZG93SGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL14jLywgJycpO1xuICAgICAgICAgICAgaWYgKHdpbmRvd0hhc2ggPT09IHBhdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9uYXZpZ2F0ZVRvKHBhdGgsIHN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyMnICsgcGF0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX25hdmlnYXRlVG8ocGF0aCwgc3RhdGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9yZWdpc3Rlck9uSGFzaENoYW5nZSgpIHtcbiAgICAgICAgY29uc3QgcGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL14jLywgJycpO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0ZVRvKHBhdGgsIG51bGwpO1xuICAgIH1cbiAgICBfcm91dGVNYXRjaGVyKHJvdXRlLCBwYXRoKSB7XG4gICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgY29uc3QgX21hdGNoZXIgPSBuZXcgUmVnRXhwKHJvdXRlLnJlcGxhY2UoLzpbXlxccy9dKy9nLCAnKFtcXFxcdy1dKyknKSk7XG4gICAgICAgICAgICByZXR1cm4gcGF0aC5tYXRjaChfbWF0Y2hlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm91dGUgPT09IHBhdGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX25hdmlnYXRlVG8ocGF0aCwgc3RhdGUpIHtcbiAgICAgICAgY29uc3QgdVBhcmFtcyA9IHBhdGguc3BsaXQoJy8nKS5maWx0ZXIoKGgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBoLmxlbmd0aCA+IDA7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCByb3V0ZUFyciA9IFN0YXRpY1JvdXRlci5yb3V0ZUxpc3QuZmlsdGVyKChyb3V0ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHJvdXRlLlBhcmFtcy5sZW5ndGggPT09IHVQYXJhbXMubGVuZ3RoICYmIHRoaXMuX3JvdXRlTWF0Y2hlcihyb3V0ZS5VcmwsIHBhdGgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocm91dGUuVXJsID09PSBwYXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgcm91dGVJdGVtID0gcm91dGVBcnIubGVuZ3RoID4gMCA/IHJvdXRlQXJyWzBdIDogbnVsbDtcbiAgICAgICAgaWYgKHJvdXRlSXRlbSkge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJvdXRlLnBhdGggPSBwYXRoO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJvdXRlLnN0YXRlID0geyAuLi4oc3RhdGUgfHwge30pIH07XG4gICAgICAgICAgICB3cmFwSW50b09ic2VydmFibGUocm91dGVJdGVtLmNhbkFjdGl2YXRlKCkpLnN1YnNjcmliZSgodmFsKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWwpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBfcGFyYW1zID0gU3RhdGljUm91dGVyLmNoZWNrUGFyYW1zKHVQYXJhbXMsIHJvdXRlSXRlbSk7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKF9wYXJhbXMpLmxlbmd0aCA+IDAgfHwgcGF0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50Um91dGUucGFyYW1zID0gX3BhcmFtcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyb3V0ZUl0ZW0uSXNSZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocm91dGVJdGVtLlRlbXBsYXRlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBJbnRvT2JzZXJ2YWJsZShyb3V0ZUl0ZW0uVGVtcGxhdGVQYXRoKCkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlSXRlbS5Jc1JlZ2lzdGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZS5uZXh0KHJvdXRlSXRlbS5UZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZS5uZXh0KHJvdXRlSXRlbS5UZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVUbyhyb3V0ZUl0ZW0ucmVkaXJlY3RUbywgc3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcbkludGVybmFsUm91dGVyID0gX19kZWNvcmF0ZShbXG4gICAgSW5qZWN0YWJsZSgpXG5dLCBJbnRlcm5hbFJvdXRlcik7XG5leHBvcnQgeyBJbnRlcm5hbFJvdXRlciB9O1xuIiwiaW1wb3J0IHsgX19kZWNvcmF0ZSwgX19tZXRhZGF0YSB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBodG1sLCBSZW5kZXJlciB9IGZyb20gJ0BwbHVtZWpzL2NvcmUnO1xuaW1wb3J0IHsgSW50ZXJuYWxSb3V0ZXIgfSBmcm9tICcuL2ludGVybmFsUm91dGVyLnNlcnZpY2UnO1xubGV0IFJvdXRlck91dGxldCA9IGNsYXNzIFJvdXRlck91dGxldCB7XG4gICAgaW50ZXJuYWxSb3V0ZXJTcnZjO1xuICAgIHJlbmRlcmVyO1xuICAgIF90ZW1wbGF0ZSA9ICcnO1xuICAgIF90ZW1wbGF0ZVN1YnNjcmlwdGlvbjtcbiAgICBjb25zdHJ1Y3RvcihpbnRlcm5hbFJvdXRlclNydmMsIHJlbmRlcmVyKSB7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxSb3V0ZXJTcnZjID0gaW50ZXJuYWxSb3V0ZXJTcnZjO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgfVxuICAgIGJlZm9yZU1vdW50KCkge1xuICAgICAgICB0aGlzLl90ZW1wbGF0ZVN1YnNjcmlwdGlvbiA9IHRoaXMuaW50ZXJuYWxSb3V0ZXJTcnZjLmdldFRlbXBsYXRlKCkuc3Vic2NyaWJlKCh0bXBsKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZSA9IHRtcGw7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbnRlcm5hbFJvdXRlclNydmMuc3RhcnRIYXNoQ2hhbmdlKCk7XG4gICAgfVxuICAgIG1vdW50KCkge1xuICAgICAgICBjb25zdCBwYXRoID0gd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgvXiMvLCAnJyk7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxSb3V0ZXJTcnZjLm5hdmlnYXRlVG8ocGF0aCwgbnVsbCk7XG4gICAgfVxuICAgIHVubW91bnQoKSB7XG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxSb3V0ZXJTcnZjLnN0b3BIYXNoQ2hhbmdlKCk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuX3RlbXBsYXRlKSB7XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheSA9IFtgJHt0aGlzLl90ZW1wbGF0ZX1gXTtcbiAgICAgICAgICAgIHN0cmluZ0FycmF5LnJhdyA9IFtgJHt0aGlzLl90ZW1wbGF0ZX1gXTtcbiAgICAgICAgICAgIHJldHVybiBodG1sKHN0cmluZ0FycmF5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBodG1sIGBgO1xuICAgICAgICB9XG4gICAgfVxufTtcblJvdXRlck91dGxldCA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAncm91dGVyLW91dGxldCdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0ludGVybmFsUm91dGVyLCBSZW5kZXJlcl0pXG5dLCBSb3V0ZXJPdXRsZXQpO1xuIiwiaW1wb3J0IHsgX19kZWNvcmF0ZSwgX19tZXRhZGF0YSB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0BwbHVtZWpzL2NvcmUnO1xuaW1wb3J0IHsgaXNOb2RlIH0gZnJvbSAnYnJvd3Nlci1vci1ub2RlJztcbmltcG9ydCB7IEludGVybmFsUm91dGVyIH0gZnJvbSAnLi9pbnRlcm5hbFJvdXRlci5zZXJ2aWNlJztcbmltcG9ydCB7IFN0YXRpY1JvdXRlciB9IGZyb20gJy4vc3RhdGljUm91dGVyJztcbmxldCBSb3V0ZXIgPSBjbGFzcyBSb3V0ZXIge1xuICAgIGludGVybmFsUm91dGVyO1xuICAgIGNvbnN0cnVjdG9yKGludGVybmFsUm91dGVyKSB7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxSb3V0ZXIgPSBpbnRlcm5hbFJvdXRlcjtcbiAgICB9XG4gICAgZ2V0Q3VycmVudFJvdXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFJvdXRlci5nZXRDdXJyZW50Um91dGUoKTtcbiAgICB9XG4gICAgbmF2aWdhdGVUbyhwYXRoLCBzdGF0ZSkge1xuICAgICAgICB0aGlzLmludGVybmFsUm91dGVyLm5hdmlnYXRlVG8ocGF0aCwgc3RhdGUpO1xuICAgIH1cbiAgICBzdGF0aWMgcmVnaXN0ZXJSb3V0ZXMocm91dGVzLCBwcmVsb2FkQWxsUm91dGVzID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCFpc05vZGUpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJvdXRlcykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJvdXRlIG9mIHJvdXRlcykge1xuICAgICAgICAgICAgICAgICAgICBTdGF0aWNSb3V0ZXIuZm9ybWF0Um91dGUocm91dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmVsb2FkQWxsUm91dGVzICYmIFN0YXRpY1JvdXRlci5wcmVsb2FkUm91dGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcigncm91dGVyLmFkZFJvdXRlczogdGhlIHBhcmFtZXRlciBtdXN0IGJlIGFuIGFycmF5Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuUm91dGVyID0gX19kZWNvcmF0ZShbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbSW50ZXJuYWxSb3V0ZXJdKVxuXSwgUm91dGVyKTtcbmV4cG9ydCB7IFJvdXRlciB9O1xuIl0sIm5hbWVzIjpbIlN0YXRpY1JvdXRlciIsInN0YXRpYyIsInVwIiwiciIsInBtYyIsInBvIiwicGMiLCJQYXJhbUNvdW50IiwiaSIsImxlbmd0aCIsInJ0UGFyYW0iLCJQYXJhbXMiLCJpbmRleE9mIiwic3BsaXQiLCJwIiwiZm9yRWFjaCIsImsiLCJvYmoiLCJVcmwiLCJUZW1wbGF0ZSIsIklzUmVnaXN0ZXJlZCIsInJlZGlyZWN0VG8iLCJjYW5BY3RpdmF0ZSIsInBhdGgiLCJmaWx0ZXIiLCJoIiwidGVtcGxhdGUiLCJ0ZW1wbGF0ZVBhdGgiLCJFcnJvciIsIlRlbXBsYXRlUGF0aCIsImdldFBhcmFtQ291bnQiLCJyb3V0ZUxpc3QiLCJwdXNoIiwicm91dGUiLCJTdWJqZWN0T2JzIiwiX2ludGVybmFsRm4iLCJhc09ic2VydmFibGUiLCJzdWJzY3JpYmUiLCJmbiIsInRoaXMiLCJ1bnN1YnNjcmliZSIsIm5leHQiLCJ2YWx1ZSIsIndyYXBJbnRvT2JzZXJ2YWJsZSIsInRoZW4iLCJpc1Byb21pc2UiLCJpbnB1dCIsIlByb21pc2UiLCJyZXNvbHZlIiwib2ZPYnMiLCJJbnRlcm5hbFJvdXRlciIsIl9jdXJyZW50Um91dGUiLCJwYXJhbXMiLCJzdGF0ZSIsIl90ZW1wbGF0ZSIsIl91blN1YnNjcmliZUhhc2hFdmVudCIsInN0YXJ0SGFzaENoYW5nZSIsInRhcmdldCIsImV2ZW50TmFtZSIsIm9uTmV4dCIsIm9wdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImZyb21WYW5pbGxhRXZlbnQiLCJ3aW5kb3ciLCJfcmVnaXN0ZXJPbkhhc2hDaGFuZ2UiLCJzdG9wSGFzaENoYW5nZSIsImdldFRlbXBsYXRlIiwiZ2V0Q3VycmVudFJvdXRlIiwibmF2aWdhdGVUbyIsImxvY2F0aW9uIiwiaGFzaCIsInJlcGxhY2UiLCJfbmF2aWdhdGVUbyIsIl9yb3V0ZU1hdGNoZXIiLCJfbWF0Y2hlciIsIlJlZ0V4cCIsIm1hdGNoIiwidVBhcmFtcyIsInJvdXRlQXJyIiwicm91dGVJdGVtIiwidmFsIiwiX3BhcmFtcyIsImNoZWNrUGFyYW1zIiwiT2JqZWN0Iiwia2V5cyIsIlJvdXRlck91dGxldCIsImludGVybmFsUm91dGVyU3J2YyIsInJlbmRlcmVyIiwiX3RlbXBsYXRlU3Vic2NyaXB0aW9uIiwiY29uc3RydWN0b3IiLCJiZWZvcmVNb3VudCIsInRtcGwiLCJ1cGRhdGUiLCJtb3VudCIsInVubW91bnQiLCJyZW5kZXIiLCJzdHJpbmdBcnJheSIsInJhdyIsInNlbGVjdG9yIiwiUm91dGVyIiwiaW50ZXJuYWxSb3V0ZXIiLCJyb3V0ZXMiLCJwcmVsb2FkQWxsUm91dGVzIiwiQXJyYXkiLCJpc0FycmF5IiwiZm9ybWF0Um91dGUiLCJwcmVsb2FkUm91dGVzIl0sInNvdXJjZVJvb3QiOiIifQ==